<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NETPHARM – CoAN-SAFE Algorithm</title>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 40px;
  background-color: #f5f6f7;
}
h1 { color: #0a2f66; }

.box {
  background: #eec9e7;
  border: 2px solid #ccc;
  padding: 20px;
  margin-top: 20px;
  border-radius: 10px;
}

.recommendation-box {
  padding: 15px;
  border-radius: 8px;
  margin-top: 15px;
  border: 1px solid #ccc;
  white-space: pre-wrap;
}

.avoid { background-color: #f65513; }
.caution { background-color: #ffc000; }
.possible { background-color: #70ad47; }

.checkbox-group label {
  display: block;
  margin: 5px 0;
}

select, label, button {
  font-size: 16px;
}

#logo {
  height: 4cm;
  width: 4cm;
  vertical-align: middle;
  margin-bottom: 10px;
}

.references {
  font-size: 10px;
  margin-top: 40px;
  color: #333;
}

.monitoring {
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px dashed #666;
}
</style>
</head>

<body>

<img src="netpharm_logo_znacka.png" id="logo" alt="NETPHARM Logo">

<h1>
CoAN-SAFE ALGORITHM:<br>
Optimising the Use of Psychotropic Coanalgesics in Frail Older Adults<br>
with Hepatorenal and/or Cardiorenal Syndromes and Neuropathic Pain
</h1>

<p><em>
A Clinical Algorithm Developed Under the NETPHARM Project
(New Technologies for Translational Research in Pharmaceutical Sciences).
Project ID CZ.02.01.01/00/22_008/0004607, co-funded by the European Union.
</em></p>

<p>
The CoAN-SAFE algorithm is a safety-oriented clinical decision-support tool
for the use of psychotropic co-analgesics in frail older adults with neuropathic
pain and multimorbidity.
</p>

<p>
First, select the type of neuropathic pain (if known). If unknown or off-label,
choose “Not specified / off-label use”.
</p>

<p>
Next, select relevant patient risk domains (frailty, renal, hepatic, cardiovascular).
</p>

<div class="box">

<label><strong>1. Select type of neuropathic pain:</strong></label>
<select id="painType">
  <option value="">-- Choose --</option>
  <option value="diabetic">Diabetic neuropathy</option>
  <option value="postherpetic">Postherpetic neuropathy</option>
  <option value="trigeminal">Trigeminal neuralgia</option>
  <option value="central">Central pain</option>
  <option value="unspecified">Not specified / off-label use</option>
</select>

<div id="medicationsBox" style="display:none; margin-top:15px;">
  <label><strong>2. Select medication:</strong></label>
  <select id="medication"></select>
</div>

<div id="comorbidityBox" style="display:none; margin-top:15px;">
  <label><strong>3. Select comorbidities:</strong></label>
  <div class="checkbox-group">
    <label><input type="checkbox" value="renal"> Renal impairment</label>
    <label><input type="checkbox" value="hepatic"> Hepatic impairment</label>
    <label><input type="checkbox" value="cardiac"> Cardiovascular risk</label>
    <label><input type="checkbox" value="frailty"> Frailty</label>
  </div>
  <button id="showRecBtn">Show recommendations</button>
</div>

<div id="recommendation"></div>

</div>

<div class="references">
<strong>Guideline references:</strong><br>
EFNS 2010; NICE CG173; CPS 2022; AAN 2022<br><br>
<strong>Non-commercial academic and clinical use only.</strong>
</div>

<script>
/* ---------- DATA ---------- */

const drugOptions = {
  diabetic: ["Amitriptyline","Duloxetine","Venlafaxine","Gabapentin","Pregabalin"],
  postherpetic: ["Amitriptyline","Duloxetine","Venlafaxine","Gabapentin","Pregabalin"],
  trigeminal: ["Carbamazepine"],
  central: ["Amitriptyline","Duloxetine","Venlafaxine","Gabapentin","Pregabalin"],
  unspecified: ["Amitriptyline","Duloxetine","Venlafaxine","Gabapentin","Pregabalin","Carbamazepine"]
};

/* ⚠️ SEM VLOŽ SVÉ PLNÉ TEXTY (stejné jako dřív) */
const recommendations = {
  amitriptyline: {
    renal: '<div class="recommendation-box caution"><b>Risks:</b> ...<br><b>Risk monitoring:</b> ...<br><b>Dose adjustment:</b> ...<br><b>Recommendation:</b> ...</div>',
    hepatic: '<div class="recommendation-box avoid"><b>Risks:</b> ...<br><b>Risk monitoring:</b> ...<br><b>Dose adjustment:</b> ...<br><b>Recommendation:</b> ...</div>',
    cardiac: '<div class="recommendation-box avoid"><b>Risks:</b> ...<br><b>Risk monitoring:</b> ...<br><b>Dose adjustment:</b> ...<br><b>Recommendation:</b> ...</div>',
    frailty: '<div class="recommendation-box avoid"><b>Risks:</b> ...<br><b>Risk monitoring:</b> ...<br><b>Dose adjustment:</b> ...<br><b>Recommendation:</b> ...</div>'
  }
  /* ostatní léky nech beze změny – stejné jako předtím */
};

/* ---------- HELPERS ---------- */

function splitMonitoring(html) {
  const m = '<b>Risk monitoring:</b>';
  const d = '<br><b>Dose adjustment:</b>';
  const i = html.indexOf(m);
  const j = html.indexOf(d);
  if (i === -1 || j === -1) return {main: html, mon: ''};
  return {
    main: html.slice(0,i) + html.slice(j),
    mon: html.slice(i,j)
  };
}

/* ---------- LOGIC ---------- */

const painType = document.getElementById('painType');
const medsBox = document.getElementById('medicationsBox');
const medsSel = document.getElementById('medication');
const comBox = document.getElementById('comorbidityBox');
const recBox = document.getElementById('recommendation');

painType.onchange = () => {
  medsSel.innerHTML = '<option value="">-- Choose --</option>';
  recBox.innerHTML = '';
  comBox.style.display = 'none';

  if (!drugOptions[painType.value]) return;

  drugOptions[painType.value].forEach(d => {
    medsSel.innerHTML += `<option value="${d.toLowerCase()}">${d}</option>`;
  });
  medsBox.style.display = 'block';
};

medsSel.onchange = () => {
  comBox.style.display = 'block';
  recBox.innerHTML = '';
};

document.getElementById('showRecBtn').onclick = () => {
  recBox.innerHTML = '';
  let hasMon = false;

  document.querySelectorAll('.checkbox-group input:checked').forEach(cb => {
    const html = recommendations[medsSel.value]?.[cb.value];
    if (!html) return;

    const p = splitMonitoring(html);
    if (p.mon) hasMon = true;

    recBox.innerHTML += p.main.replace('</div>', `<div class="monitoring" style="display:none">${p.mon}</div></div>`);
  });

  if (hasMon) {
    recBox.innerHTML += `
      <label style="display:block;margin-top:15px">
        <input type="checkbox" id="toggleMon"> Show risk monitoring
      </label>`;
    document.getElementById('toggleMon').onchange = e =>
      document.querySelectorAll('.monitoring').forEach(m => m.style.display = e.target.checked ? 'block':'none');
  }
};
</script>

</body>
</html>
